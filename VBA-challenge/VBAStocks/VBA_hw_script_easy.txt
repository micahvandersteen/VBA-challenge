' Author: Micah Vandersteen' This script is intended to loop through all the stocks for' one year for each run and obtain:' the ticker, annual change, percent annual change, and total volume.' The script also provides conditional formatting that will' highlight positive change in green and negative in red.Sub annualStocks():' creating column headers for desired information---------------------Range("I1").Value = "Ticker Symbol"Range("J1").Value = "Yearly Change"Range("K1").Value = "Percent Change"Range("L1").Value = "Total Volume"' defining variables----------------------------------------------' defining the ticker variableDim ticker As Variant' defining the yearly change variableDim yearlyChange As Double' defining the yearly percent change variableDim percentChange As Double' defining the stock total volumeDim totalVolume As Variant    totalVolume = 0' defining the iteration variableDim i As VariantDim lastRow As Variant ' variable for finding last row of given ticker    lastRow = ActiveSheet.Cells(Rows.Count, 1).End(xlUp).Row ' finding amount of rowsDim summaryRow As Variant    summaryRow = 2   Dim day As StringDim openPrice As VariantDim closePrice As Variant   ' For loop to run through the full year for each stock-------------------------' intializing for loop from row 2 to the last rowFor i = 2 To lastRow        ' creating a way to identify dates, ignoring the year    'makes the date a string    day = Cells(i, 2).Value        'removes year from the string    dDay = Right(day, 4)        'identifies opening price on january first of each stock    If (dDay = "0101") Then        openPrice = Cells(i, 3).Value    End If        ' initializing conditional to check when stock ticker changes    If (Cells(i + 1, 1).Value <> Cells(i, 1).Value) Then                ticker = Cells(i, 1).Value ' set ticker name        Range("I" & summaryRow).Value = ticker ' placing the ticker into the summary position                totalVolume = totalVolume + Cells(i, 7).Value ' gets total volume of stock        Range("L" & summaryRow).Value = totalVolume ' places total volume into summary position                ' get closing price        closePrice = Cells(i, 6).Value                ' get yearly change        yearlyChange = closePrice - openPrice        Range("J" & summaryRow).Value = yearlyChange                'get percent change        If (openPrice <> 0) Then            percentChange = (closePrice / openPrice) * 100 - 100            Range("K" & summaryRow).Value = percentChange        Else            MsgBox ("For" & ticker & "the open price is zero at the beginning of the year and a percent change cannot be calculated.")        End If                ' using conditional to format such that positive change is a green cell and negtive hcnage is a red cell        If (percentChange > 0) Then            Range("K" & summaryRow).Interior.ColorIndex = 4            Range("J" & summaryRow).Interior.ColorIndex = 4        ElseIf (percentChange < 0) Then            Range("K" & summaryRow).Interior.ColorIndex = 3            Range("J" & summaryRow).Interior.ColorIndex = 3        End If                        summaryRow = summaryRow + 1 ' increments summary row position for next ticker                totalVolume = 0 ' resets total volume for the next ticker                    Else            totalVolume = totalVolume + Cells(i, 7).Value            End If        Next iEnd Sub